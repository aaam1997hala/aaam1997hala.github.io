
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>تسجيل صبة جديدة</title>
    <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js"></script>
    <script>
      const firebase = window.firebase;
    </script>
</head>
<body>
    <h2>نموذج تسجيل صبة</h2>
    <form id="pourForm">
        <label>اسم المقاول: <input type="text" id="contractorName" required></label><br><br>
        <label>رقم الهاتف: <input type="text" id="phone" required></label><br><br>
        <label>نوع الكونكريت:
            <select id="concreteType">
                <option value="C15">C15</option>
                <option value="C20">C20</option>
                <option value="C25">C25</option>
                <option value="C30">C30</option>
                <option value="C35">C35</option>
                <option value="C40">C40</option>
            </select>
        </label><br><br>
        <label>عدد الخلطات: <input type="number" id="truckCount" required></label><br><br>
        <label>ملاحظات: <textarea id="notes"></textarea></label><br><br>
        <button type="submit">خزن البيانات</button>
    </form>
    <p id="status"></p>

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCXzrU5KCshVh6nE6vNcWMKNX-8hQl3GCk",
        authDomain: "concrete-anwar-shatra.firebaseapp.com",
        projectId: "concrete-anwar-shatra",
        storageBucket: "concrete-anwar-shatra.firebasestorage.app",
        messagingSenderId: "793150573127",
        appId: "1:793150573127:web:4d5fc0119c573f63fa7f62",
        measurementId: "G-3VW8YVLSW6"
      };

      const app = firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      document.getElementById("pourForm").addEventListener("submit", async (e) => {
        e.preventDefault();
        const contractorName = document.getElementById("contractorName").value;
        const phone = document.getElementById("phone").value;
        const concreteType = document.getElementById("concreteType").value;
        const truckCount = document.getElementById("truckCount").value;
        const notes = document.getElementById("notes").value;
        const deliveryDate = new Date().toISOString().split('T')[0];

        try {
          await db.collection("deliveries").add({
            contractorName,
            phone,
            concreteType,
            truckCount,
            notes,
            deliveryDate,
            smsSent: false
          });
          document.getElementById("status").textContent = "تم الحفظ بنجاح";
          document.getElementById("pourForm").reset();
        } catch (error) {
          document.getElementById("status").textContent = "فشل في الحفظ: " + error.message;
        }
      });
    </script>
</body>
</html>
